!function(e){var t={};function n(a){if(t[a])return t[a].exports;var s=t[a]={i:a,l:!1,exports:{}};return e[a].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:a})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=4)}([function(e,t){},function(e,t){var n,a,s=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function i(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{a="function"==typeof clearTimeout?clearTimeout:r}catch(e){a=r}}();var c,u=[],l=!1,p=-1;function m(){l&&c&&(l=!1,c.length?u=c.concat(u):p=-1,u.length&&f())}function f(){if(!l){var e=i(m);l=!0;for(var t=u.length;t;){for(c=u,u=[];++p<t;)c&&c[p].run();p=-1,t=u.length}c=null,l=!1,function(e){if(a===clearTimeout)return clearTimeout(e);if((a===r||!a)&&clearTimeout)return a=clearTimeout,clearTimeout(e);try{a(e)}catch(t){try{return a.call(null,e)}catch(t){return a.call(this,e)}}}(e)}}function d(e,t){this.fun=e,this.array=t}function g(){}s.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new d(e,t)),1!==u.length||l||i(f)},d.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=g,s.addListener=g,s.once=g,s.off=g,s.removeListener=g,s.removeAllListeners=g,s.emit=g,s.prependListener=g,s.prependOnceListener=g,s.listeners=function(e){return[]},s.binding=function(e){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},function(e,t,n){(function(e){console.log("this is loaded"),t.spotify={id:e.env.SPOTIFY_ID,secret:e.env.SPOTIFY_SECRET}}).call(this,n(1))},function(e,t,n){n(2);$("#on-photo-upload-correct").hide(),$("#on-photo-upload-error").hide(),$(".results").hide(),$("#user-image").hide();firebase.initializeApp({apiKey:"AIzaSyAwSQJpM8wQUVAYLmThPdPVeDFbNVkazvI",authDomain:"facejam-1f0e6.firebaseapp.com",databaseURL:"https://facejam-1f0e6.firebaseio.com",projectId:"facejam-1f0e6",storageBucket:"",messagingSenderId:"174049412327"});var a=firebase.database();$("#photo-submit").change(function(e){for(var t=0;t<e.originalEvent.srcElement.files.length;t++){var n=e.originalEvent.srcElement.files[t],a=document.createElement("img"),s=new FileReader;s.onloadend=function(){a.src=s.result},s.readAsDataURL(n),$("uploaded-photo-display").append(a)}}),$("#submit-button").on("click",function(){$("#on-photo-upload-correct").hide(),$("#mood-values").empty(),formData=new FormData,a.ref().push(formData);var e=$("#photo-submit")[0].files[0];console.log(e),formData.append("api_key","laayC4Q2zbJVehmHJQaShRBlXte6GOHY"),formData.append("api_secret","dAJDmzmDj5f_lj93y_AoEqhgtT0WGPLI"),formData.append("return_attributes","emotion"),formData.append("image_file",e),console.log(formData);$.ajax({url:"https://cors-anywhere.herokuapp.com/https://api-us.faceplusplus.com/facepp/v3/detect",method:"POST",processData:!1,contentType:!1,data:formData}).then(function(e){if(console.log(e),!0===e.error_message)$("#on-photo-upload-error").show();else if(e.time_used>0){$("#on-photo-upload-correct").show();var t=e.faces[0].attributes.emotion.happiness,n=e.faces[0].attributes.emotion.neutral,a=e.faces[0].attributes.emotion.disgust,s=e.faces[0].attributes.emotion.anger,o=e.faces[0].attributes.emotion.surprise,r=e.faces[0].attributes.emotion.fear,i=e.faces[0].attributes.emotion.sadness;console.log(t),console.log(n),console.log(a),console.log(s),console.log(o),console.log(r),console.log(i),$("#photo-submit").val(""),$("#mood-values").append("<h4>You're feeling:</h4><br>Happiness: "+t.toFixed(2)+"%<br>Neutral: "+n.toFixed(2)+"%<br>Disgust: "+a.toFixed(2)+"%<br>Anger: "+s.toFixed(2)+"%<br>Surprise: "+o.toFixed(2)+"%<br>Fear: "+r.toFixed(2)+"%<br>Sadness: "+i.toFixed(2)+"%<br>")}})});var s,o,r,i="min_speechiness=0.0",c="max_speechiness=0.5",u="min_tempo=80",l="max_tempo=200",p="https://api.spotify.com/v1/recommendations?limit=20&market=US&min_acousticness=0&max_acousticness=1.0&target_acousticness=1.0&min_danceability=0.0&max_danceability=1.0&target_danceability=undefined&min_energy=0.0&max_energy=1.0&target_energy="+s+"&min_loudness=-60&max_loudness=0&target_loudness="+void 0+"&min_popularity=50&max_popularity=100&target_popularity=75&"+i+"&"+c+"&target_speechiness=0.33&"+u+"&"+l+"&target_tempo="+o+"&min_valence=0.0&max_valence=1.0&target_valence="+r;if(s>=.67&&r>=.67)p="https://api.spotify.com/v1/recommendations?limit=20&market=US&min_acousticness=0&max_acousticness=1.0&target_acousticness=1.0&min_danceability=0.0&max_danceability=1.0&target_danceability=undefined&min_energy=0.0&max_energy=1.0&target_energy="+s+"&min_loudness=-60&max_loudness=0&target_loudness="+void 0+"&min_popularity=50&max_popularity=100&target_popularity=75&"+i+"&"+c+"&target_speechiness=0.33&"+u+"&"+l+"&target_tempo="+o+"&min_valence=0.0&max_valence=1.0&target_valence="+r;else p="https://api.spotify.com/v1/recommendations?limit=20&market=US&min_acousticness=0&max_acousticness=1.0&target_acousticness=1.0&min_energy=0.0&max_energy=1.0&target_energy="+s+"&min_loudness=-60&max_loudness=0&target_loudness="+void 0+"&min_popularity=50&max_popularity=100&target_popularity=75&"+i+"&"+c+"&target_speechiness=0.33&"+u+"&"+l+"&target_tempo="+o+"&min_valence=0.0&max_valence=1.0&target_valence="+r;surprise>=.67||happiness>=.67||fear>=.67||disgust>=.5&&fear+anger+surprise<=.5?(o=170,u="min_tempo=150"):sadness>=.67||sadness<=.5&&neutral<=.5?(o=120,l="max_tempo=140"):neutral>.5&&(o=145,u="min_tempo=120",l="max_tempo=170"),r=happiness>sadness+anger?happiness-(sadness+anger):sadness+anger-happiness,sadness>.5||neutral>.5?s=1-(sadness+neutral):sadness<.5||neutral<.5?s=1-(sadness+neutral-disgust):(anger>.67||happiness>.67||surprise>.67)&&(s=0+(anger+happiness+surprise)/3,.33<disgust<.67&&(s-=disgust),s-=(sadness+neutral)/2),$("#happiness").on("click",function(){happiness=.9,console.log(happiness)}),$("#neutral").on("click",function(){neutral=.9,console.log(neutral)}),$("#sadness").on("click",function(){sadness=.9,console.log(sadness)}),$("#anger").on("click",function(){anger=.9,console.log(anger)}),$("#surprise").on("click",function(){surprise=.9,console.log(surprise)}),$("#fear").on("click",function(){fear=.9,console.log(fear)}),$("#disgust").on("click",function(){disgust=.9,console.log(disgust)});var m,f,d=firebase.database();d.ref("/Yes").on("value",function(e){console.log(e.val()),m=e.val().yesCount},function(e){console.log("The read failed: "+e.code)}),d.ref("/No").on("value",function(e){console.log(e.val()),f=e.val().noCount},function(e){console.log("The read failed: "+e.code)}),$("#accurate-yes").on("click",function(){m++,$(".accuracy").hide(),$("#thanks").text("Thanks for your feedback!"),d.ref("Yes").set({yesCount:m})}),$("#accurate-no").on("click",function(){f++,$(".accuracy").hide(),$("#thanks").text("Thanks for your feedback!"),d.ref("No").set({noCount:f})});var g=[],h={artist:[],track:[],album:"",trackLink:"",albumLink:"",artistLink:[]};$.ajax({url:p,method:"GET",accept:"application/json","content-type":"application/json"}).then(function(e){e.tracks.forEach(t=>{e.tracks[t].album.artists.forEach(t=>{h.artist.push(e.tracks[t].album.artists[t].name)}),e.tracks[t].artists.forEach(t=>{var n=0;(n=h.track.length)>0&&(e.tracks[t].artists[t].name,h.track[n-1]),h.track.push(e.tracks[t].artists[t].name),(n=h.artistLink.length)>0&&(e.tracks[t].artists[t].external_urls.spotify,h.artistLink[n-1]),trackResul.artistLink.push(e.tracks[t].artists[t].external_urls.spotify)}),h.album=e.tracks[t].album.name,h.trackLink=e.tracks[t].external_urls.spotify,h.albumLink=e.tracks[t].album.external_urls.spotify,g.push(h)})}),g.forEach(e=>{var t=$("<td>").attr("class","artistName").attr("id","artistNumber"+e),n=$("<tr>"),a=$("<td>").attr("class","songName").attr("id","songNumber"+e);$(t).text(g[e].artist.val().toString()),$(a).text(g[e].track),$(n).append(t),$(n).append(t),$("table").append(n)})},function(e,t,n){n(3),e.exports=n(0)}]);